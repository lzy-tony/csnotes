# 数学前置

## 欧拉函数

定义：$\mathbb Z_m$ 中所有与 $m$ 互素的个数使用 $\phi(m)$ 表示，称为欧拉函数。

定理：设

$$
m = \prod \limits_{i = 1}^n p_i^{e_i}
$$

这里 $p_i$ 均为素数且互不相同，$e_i > 0, 1 \le i \le n$，则：

$$
\phi(m) = \prod \limits_{i = 1}^n (p_i^{e_i} - p_i^{e_i - 1})
$$

欧拉定理：若 $a, m \in \mathbb N_+$，且 $\text{gcd}(a, m) = 1$，则有：

$$
a^{\phi(m)} \equiv 1 \mod m
$$

> 推论：费马小定理
>
> 若 $a, m \in \mathbb N_+$，且 $m$ 为素数，则有：
> 
> $$
> a^{m - 1} \equiv 1 \mod m
> $$



## 有限域

### 多项式伽罗瓦域

$\text{GF}(p^n)$：系数在 $p$ 上的次数为 $n - 1$ 的多项式的集合。

例如有限域 $\text{GF}(2^8)$。

#### 加法

例：

$$
(x^6 + x^4 + x^2 + x + 1) \oplus (x^7 + x + 1) = x^7 + x^6 + x^4 + x^2
$$


#### 乘法

模二元域 $\text{GF}(2)$ 上一个8次不可约多项式的乘积。



#### 乘法逆元

扩展欧几里得算法求解。

对于模一个不可约多项式的情况，扩展欧几里得算法所求解的同余方程

$$
ax + by = \text{gcd}(a, b)
$$

退化为

$$
ax + by = 1
$$

即

$$
ax = 1 \mod b
$$



## 素性检验

### 确定性算法

试除小于 $\sqrt n$ 的整数。



### 概率算法

#### Fermat 检验

引理（Fermat 小定理）：若 $n$ 是素数，则

$$
a^{n - 1} \equiv 1 \mod n
$$

Fermat 检验：对于选取的 $a$，检验是否满足。

- 如果 $n$ 是素数，则一定满足；
- 如果 $n$ 是合数，则可能满足。



#### 平方根检验

引理：

- 如果 $n$ 是素数，$1$ 在模 $n$ 意义下的平方根一定是 $\pm 1$。
- 如果 $n$ 是合数，$1$ 在模 $n$ 意义下的平方根是 $\pm 1$ 和其它可能值。

> 证明：
>
> 若 $x$ 是 $1$ 在模 $n$ 意义下的平方根（$x < n$），则有
> 
> $$
> x^2 \equiv 1 \mod n
> $$
> 
> 变形得到
> 
> $$
> (x - 1)(x + 1) = pn
> $$
> 
> 则 $x = \pm 1$。



#### Miller-Rabin 检验

Motivation：同时结合 Fermat 检验和平方根检验。

考虑 $n - 1$，将其分解为 $m \times 2^k$，其中 $m$ 为奇数，则 Fermat 检验所需要的 $a^{n - 1}$ 可以写成：

$$
a^{n - 1} = a^{m \times 2^k} = [a^m]^{2^{\cdot^{\cdot^{2}}}}
$$

此时我们只需要逐次验证：

1. $a^m \equiv 1 \mod n$，则为质数；
2. $a^{2^j m} \equiv -1 \mod n, 0 \le j < k$，则为质数；
3. 否则为合数。



## 中国剩余定理

对于特定的同余方程组可以使用中国剩余定理进行求解。

假定 $m_1, \dots, m_r$ 为两两互素的正整数，假定 $a_1, \dots, a_r$ 是整数，考虑如下的同余方程组：

$$
x \equiv a_1 \mod m_1 \\
x \equiv a_2 \mod m_2 \\
\vdots \\
x \equiv a_r \mod m_r 
$$

中国剩余定理断言其模 $M = \prod m_i$ 有唯一解。

令 $M_i = \frac{M}{m_i}$，$y_i = M_i^{-1} \mod m_i$， 则一定有

$$
x \equiv \sum \limits_{i = 1}^r a_iM_iy_i
$$



## 离散对数问题

设 $p$ 是一个素数，则模 $p$ 的既约剩余系 $(\mathbb Z_p^*, \times)$ 构成循环群。

定义（原根）：称 $a$ 是素数 $p$ 的一个原根，当且仅当 $a, a^2, \dots, a^{p - 1} \mod p$ 是 $1, \dots, p - 1$ 的一个置换。

>  原根素数 $p$ 是既约剩余系所形成的循环群的生成元。

定义（离散对数）：对于整数 $b < p$ 和素数 $p$ 的一个原根 $a$，可以找到唯一的指数 $i$，使得

$$
b \equiv a^i \mod p
$$

其中 $0 \le i \le p - 1$ 称为以 $b$ 为底模 $p$ 的离散对数。

定义（离散对数问题）：对于 $b = a^x \mod p$：

- 已知 $a, x, p$：计算 $b$ 是容易的。
- 已知 $a, b, p$：计算 $x$ 是困难的。

