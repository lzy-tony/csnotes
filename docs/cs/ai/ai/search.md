# 搜索

## 搜索问题

一个搜索问题包含以下要素：

- 状态空间 $S$；
- 初始状态 $s_0$；
- 对于每个状态可选的行动集合 $A(s)$；
- 状态转移模型 $\text{Result}(s, a)$；
- 目标集合 $G(s)$；
- 以及行动的代价函数 $c(s, a, s')$。



对于搜索问题，我们通常关心：

1. 问题有解时能否找到解？
2. 找到的解是否最优？
3. 在什么情况下可以找到最优解？
4. 求解最优解的效率如何？



## 盲目搜索

### 深度优先搜索

优先扩展深度深的节点。

性质：一般 **不能保证找到最优解**。（在最坏情况下等同于穷举）



### 宽度优先搜索

优先扩展深度浅的节点。

性质：

1. 当问题有解时，一定能找到解。
2. 当问题为单位耗散值时，且问题有解时，一定能找到最优解。



### dijkstra

优先扩展距离起点最近的节点，直到终点距离最短。



## 启发式搜索

引入启发知识，使得 **在保证找到最优解的情况下，尽可能减少搜索范围，提高搜索效率**。



### A 算法

引入评价函数 $f(n) = g(n) + h(n)$，其中 $h(n)$ 为启发函数。

- $g^*(n)$：从 $s$ 到 $n$ 的最短路径的耗散值；
- $h^*(n)$：从 $n$ 到 $t$ 的最短路径的耗散值。

$g^*$ 与 $h^*$ 为最优，而 $g, h$ 为对于最优的估计值。



### A* 算法

在 A 算法中，如果满足条件 $h(n) \le h^*(n)$，则 A 算法被称为 A* 算法。

定义 $h$ 的一般原则：放宽限制条件，在宽条件下，给出估计函数。

> 例. 寻找到香山的最短距离时，利用欧氏距离作为 $h$ 函数进行估值。

定理（可采纳性定理）：若存在 $s$ 到 $t$ 的路径，则 A* 一定能找到最优解结束。

定理：如果对所有非目标节点 $h_2(n) > h_2(n)$（包含更多信息），则 $A_1$ 扩展的节点数 $\ge$ $A_2$ 扩展的节点数。



#### 对启发函数的评价

平均分叉数 $b^*$：

求解 $b^*$：考虑等价的共有 $N$ 个节点、深度为 $d$ 的 $b^*$ 叉树，则有等比数列求和公式：

$$
N = \frac{1 - {b^{*}}^{(d + 1)}}{1 - b^*}
$$

二分可求 $b^*$ 数值解。

而 $b^*$ 越小，意味着 $h$ 效果越好。

> 注：实验表明，$b^*$ 是一个比较稳定的常数，同一问题基本不随问题规模变化。



### A* 算法的改进

Motivation：在传统的A*中，同一个节点可能被多次扩展，因此可以通过对 $h$ 施加限制使得第一次扩展到某节点时就找到了从 $s$ 到该节点的最短路径。

定义（单调性）：一个启发函数 $h$，如果对所有节点 $n_i, n_j$，其中 $n_j$ 是 $n_i$ 的子节点，满足：

$$
\begin{cases}
h(n_i) - h(n_j) \le c(n_i, n_j) \\
h(t) = 0
\end{cases}
$$

则称 $h$ 是单调的。

定理：若 $h(n)$ 是单调的，则 A\* 扩展了节点 $n$ 之后，就已经找到了到达节点 $n$ 的最佳路径。即：当 A\* 选 $n$ 扩展时有 $g(n) = g^*(n)$。

定理：满足单调性一定满足 A* 条件，反之不成立。

> 证明：从目标向上归纳。

结论：

- OPEN 表中任意具有 $f(n) < f^*(s)$ 的节点一定会被 A* 扩展；
- A\* **选做扩展的任一节点，一定有 $f(n) \le f^*(s)$**；
- 当 $h(n)$ 恒等于 $0$ 时，$h$ 为单调的。

由于 $f^*(s)$ 未知，因此用当前扩展节点的最大 $f$ 值 $f_m$ 替代。



## 动态规划

### Viterbi 算法

分层图上 dp 的优化方法：

$$
Q(W_{i, j}) = \begin{cases}
\min \limits_k (Q({W_{i - 1, k}}) + D(W_{i - 1, k}, W_{i, j})) & i \neq 0 \\
0 & i = 0
\end{cases}
$$